<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <form id="formFuncionario">
        <fieldset>
            <legend>Dados Pessoais</legend>
            <label>Nome: <input type="text" name="nome" required></label><br>
            <label>CPF: <input type="text" name="cpf" required></label><br>
            <label>Email: <input type="email" name="email" required></label><br>
            <label>Salário: <input type="number" step="0.01" name="salario"></label><br>
            <label>Ativo: <input type="checkbox" name="ativo"></label><br>
        </fieldset>

        <fieldset>
            <legend>Endereço</legend>
            <label>País: <input type="text" name="pais" required></label><br>
            <label>Estado: <input type="text" name="estado" maxlength="2" required></label><br>
            <label>Cidade: <input type="text" name="cidade" required></label><br>
            <label>Bairro: <input type="text" name="bairro" required></label><br>
            <label>Logradouro: <input type="text" name="logradouro" required></label><br>
            <label>Número: <input type="text" name="numero"></label><br>
            <label>CEP: <input type="text" name="cep"></label><br>
        </fieldset>

        <fieldset>
            <legend>Departamento</legend>
            <label>ID do Departamento: <input type="number" name="idDepartamento" required></label><br>
        </fieldset>

        <button type="submit">Cadastrar</button>
    </form>

    <script>
        document.getElementById('formFuncionario').addEventListener('submit', async function (e) {
            e.preventDefault();

            const form = e.target;

            const funcionario = {
                nome: form.nome.value,
                cpf: form.cpf.value,
                email: form.email.value,
                salario: parseFloat(form.salario.value) || 0,
                ativo: form.ativo.checked,
                endereco: {
                    pais: form.pais.value,
                    estado: form.estado.value,
                    cidade: form.cidade.value,
                    bairro: form.bairro.value,
                    logradouro: form.logradouro.value,
                    numero: form.numero.value,
                    cep: form.cep.value
                },
                idDepartamento: {
                    idDepartamento: parseInt(form.idDepartamento.value)
                }
            };

            try {
                const response = await fetch('http://localhost:8080/funcionarios', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(funcionario)
                });

                if (response.ok) {
                    alert('Funcionário cadastrado com sucesso!');
                    form.reset();
                } else {
                    const errorText = await response.text();
                    alert('Erro ao cadastrar: ' + errorText);
                }
            } catch (error) {
                alert('Erro de rede: ' + error.message);
            }
        });

    </script>

</body>

</html>